import React, { useState, useEffect } from 'react';
import { CalculatorResult } from '../../types';
import { calculateAD8, calculateIPSS } from '../../utils/calculations';
import { ResultCard, formatEMR } from './Shared';

export const AD8Calculator: React.FC = () => { const [scores, setScores] = useState<boolean[]>(new Array(8).fill(false)); const [result, setResult] = useState<CalculatorResult | null>(null); useEffect(() => { const score = scores.filter(Boolean).length; setResult(calculateAD8(score)); }, [scores]); const questions = ["1. 判斷力上的困難", "2. 對活動和嗜好的興趣降低", "3. 重複相同的問題、故事或語句", "4. 學習使用工具設備有困難", "5. 忘記正確的月份和年份", "6. 處理複雜的財物有困難", "7. 記住約會的時間有困難", "8. 有持續的思考和記憶問題"]; const copyText = formatEMR('AD-8', `Score: ${scores.filter(Boolean).length}/8`, result); return ( <div className="max-w-2xl space-y-4"> <div className="bg-amber-50 p-4 border border-amber-200 rounded-lg mb-4"><p className="text-sm font-bold text-amber-900">說明：請回答過去幾年中是否有以下改變？(是 = 1分，否 = 0分)</p></div> {questions.map((q, idx) => ( <label key={idx} className={`flex items-center p-4 border-2 rounded-lg cursor-pointer transition-all shadow-sm ${scores[idx] ? 'bg-teal-50 border-teal-600' : 'bg-white border-slate-200 hover:bg-slate-50'}`}> <input type="checkbox" checked={scores[idx]} onChange={(e) => { const ns = [...scores]; ns[idx] = e.target.checked; setScores(ns); }} className="w-6 h-6 text-teal-600 rounded focus:ring-teal-500 border-slate-300" /> <span className={`ml-4 text-base font-bold ${scores[idx] ? 'text-teal-900' : 'text-slate-700'}`}>{q}</span> </label> ))} <ResultCard title="AD-8" result={result} copyContent={copyText} /> </div> ); };

export const IPSSCalculator: React.FC = () => { const [scores, setScores] = useState<number[]>(new Array(7).fill(0)); const [qol, setQol] = useState(0); const [result, setResult] = useState<CalculatorResult|null>(null); useEffect(() => setResult(calculateIPSS(scores, qol)), [scores, qol]); const copyText = formatEMR('IPSS', `Scores: [${scores.join(', ')}], QoL: ${qol}`, result); const questions = ["1. 餘尿感", "2. 頻尿", "3. 中斷性排尿", "4. 急尿", "5. 尿柱無力", "6. 需用力排尿", "7. 夜尿次數"]; const updateScore = (idx: number, val: number) => { const newScores = [...scores]; newScores[idx] = val; setScores(newScores); }; return ( <div className="max-w-2xl space-y-6"> {questions.map((q, idx) => ( <div key={idx} className="bg-white p-5 rounded-lg border-2 border-slate-200 shadow-sm"> <p className="font-bold text-black text-base mb-3">{q}</p> <div className="flex gap-1 overflow-x-auto pb-1"> {[0,1,2,3,4,5].map(v => ( <button key={v} onClick={() => updateScore(idx, v)} className={`flex-1 min-w-[48px] py-3 text-base font-bold rounded border-2 ${scores[idx] === v ? 'bg-teal-700 text-white border-teal-700' : 'bg-white border-slate-300 text-black hover:bg-slate-50'}`}>{v}</button> ))} </div> </div> ))} <div className="bg-slate-100 p-5 rounded-lg border-2 border-slate-300"> <p className="font-bold text-black text-base mb-3">生活品質 (QoL)</p> <div className="flex gap-1 overflow-x-auto pb-1"> {['高興','滿意','大致','普通','不滿','苦惱','糟透'].map((txt, i) => ( <button key={i} onClick={() => setQol(i)} className={`flex-1 min-w-[64px] py-2 text-xs font-bold rounded border-2 ${qol === i ? 'bg-indigo-600 text-white border-indigo-600' : 'bg-white border-slate-300 text-black hover:bg-slate-50'}`}>{txt}</button> ))} </div> </div> <ResultCard title="IPSS" result={result} copyContent={copyText} /> </div> ) }
